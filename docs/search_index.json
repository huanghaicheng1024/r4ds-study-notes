[["tidy-data.html", "9 Tidy data 9.1 整齐的数据 9.2 数据的常见问题与整理方法 9.3 缺失值 9.4 练习", " 9 Tidy data 学习tidyr包，用于整理（整齐）数据。 library(tidyverse) 9.1 整齐的数据 想要整理数据，就得先知道我们的目标，即所谓“整齐的数据（tidy data）”指的是怎样的数据。 类似于数据库关系数据理论的1NF，整齐的数据需满足： 每个变量必须有自己的列 每个观察值必须有自己的一行 每个值都必须有自己的单元格 在我们tidyverse的工具下，应当做到： 将每个数据集放在一个tibble中 将每个变量放在一列中 整齐数据的优势主要有两个：得到一致性的数据结构、使R的矢量化运算发挥作用。 9.2 数据的常见问题与整理方法 9.3 缺失值 一个值可能会以两种方式丢失：显示与隐式。 An explicit missing value is the presence of an absence; an implicit missing value is the absence of a presence. 处理缺失值的几种方法： 不同的数据表示使隐式缺失值值显式化，或者可以设置隐式转换显式缺失值 显式显示缺失值：complete() fill()：将缺失值替换为最近的非缺失值 9.4 练习 （1）What would happen if you widen this table? Why? How could you add a new column to uniquely identify each value? people &lt;- tribble( ~name, ~key, ~value, #-----------------|--------|------ &quot;Phillip Woods&quot;, &quot;age&quot;, 45, &quot;Phillip Woods&quot;, &quot;height&quot;, 186, &quot;Phillip Woods&quot;, &quot;age&quot;, 50, &quot;Jessica Cordero&quot;, &quot;age&quot;, 37, &quot;Jessica Cordero&quot;, &quot;height&quot;, 156 ) # name与key不能确定value people %&gt;% pivot_wider(names_from=&quot;key&quot;,values_from = &quot;value&quot;) #&gt; Warning: Values are not uniquely identified; output will contain list-cols. #&gt; * Use `values_fn = list` to suppress this warning. #&gt; * Use `values_fn = length` to identify where the duplicates arise #&gt; * Use `values_fn = {summary_fun}` to summarise duplicates #&gt; # A tibble: 2 x 3 #&gt; name age height #&gt; &lt;chr&gt; &lt;list&gt; &lt;list&gt; #&gt; 1 Phillip Woods &lt;dbl [2]&gt; &lt;dbl [1]&gt; #&gt; 2 Jessica Cordero &lt;dbl [1]&gt; &lt;dbl [1]&gt; # 添加新列 people %&gt;% group_by(name,key) %&gt;% mutate(no = row_number()) %&gt;% pivot_wider(names_from = &quot;name&quot;,values_from=&quot;value&quot;) #&gt; # A tibble: 3 x 4 #&gt; # Groups: key [2] #&gt; key no `Phillip Woods` `Jessica Cordero` #&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; #&gt; 1 age 1 45 37 #&gt; 2 height 1 186 156 #&gt; 3 age 2 50 NA （2）Tidy the simple tibble below. Do you need to make it wider or longer? What are the variables? preg &lt;- tribble( ~pregnant, ~male, ~female, &quot;yes&quot;, NA, 10, &quot;no&quot;, 20, 12 ) # longer preg %&gt;% pivot_longer(cols = c(&quot;male&quot;,&quot;female&quot;), names_to = &quot;sex&quot;, values_drop_na=T) %&gt;% # 去缺失值（怀孕，男） mutate( female = (sex==&quot;female&quot;), pregnant = (pregnant==&quot;yes&quot;) # 受启发，改为逻辑变量 ) %&gt;% select(female,pregnant,value) #&gt; # A tibble: 3 x 3 #&gt; female pregnant value #&gt; &lt;lgl&gt; &lt;lgl&gt; &lt;dbl&gt; #&gt; 1 TRUE TRUE 10 #&gt; 2 FALSE FALSE 20 #&gt; 3 TRUE FALSE 12 "]]
