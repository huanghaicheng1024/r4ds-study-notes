<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Data visualisation | r4ds学习笔记</title>
  <meta name="description" content="这是使用bookdwon编写的书籍。" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Data visualisation | r4ds学习笔记" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="这是使用bookdwon编写的书籍。" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Data visualisation | r4ds学习笔记" />
  
  <meta name="twitter:description" content="这是使用bookdwon编写的书籍。" />
  

<meta name="author" content="Huang" />


<meta name="date" content="2020-12-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="explore-intro.html"/>
<link rel="next" href="workflow-basics.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">r4ds Study Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>背景</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="part"><span><b>I Explore</b></span></li>
<li class="chapter" data-level="2" data-path="explore-intro.html"><a href="explore-intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="data-visualisation.html"><a href="data-visualisation.html"><i class="fa fa-check"></i><b>3</b> Data visualisation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-visualisation.html"><a href="data-visualisation.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="data-visualisation.html"><a href="data-visualisation.html#first-steps"><i class="fa fa-check"></i><b>3.2</b> First steps</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data-visualisation.html"><a href="data-visualisation.html#exercises"><i class="fa fa-check"></i><b>3.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data-visualisation.html"><a href="data-visualisation.html#aesthetic-mappings"><i class="fa fa-check"></i><b>3.3</b> Aesthetic mappings</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-visualisation.html"><a href="data-visualisation.html#exercises-1"><i class="fa fa-check"></i><b>3.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-visualisation.html"><a href="data-visualisation.html#common-problems"><i class="fa fa-check"></i><b>3.4</b> Common problems</a></li>
<li class="chapter" data-level="3.5" data-path="data-visualisation.html"><a href="data-visualisation.html#facets分面"><i class="fa fa-check"></i><b>3.5</b> Facets分面</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="data-visualisation.html"><a href="data-visualisation.html#exercises-2"><i class="fa fa-check"></i><b>3.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="data-visualisation.html"><a href="data-visualisation.html#几何对象"><i class="fa fa-check"></i><b>3.6</b> 几何对象</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="data-visualisation.html"><a href="data-visualisation.html#分组绘图"><i class="fa fa-check"></i><b>3.6.1</b> 分组绘图</a></li>
<li class="chapter" data-level="3.6.2" data-path="data-visualisation.html"><a href="data-visualisation.html#多个几何对象"><i class="fa fa-check"></i><b>3.6.2</b> 多个几何对象</a></li>
<li class="chapter" data-level="3.6.3" data-path="data-visualisation.html"><a href="data-visualisation.html#练习"><i class="fa fa-check"></i><b>3.6.3</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="data-visualisation.html"><a href="data-visualisation.html#统计变换"><i class="fa fa-check"></i><b>3.7</b> 统计变换</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-visualisation.html"><a href="data-visualisation.html#底层实现"><i class="fa fa-check"></i><b>3.7.1</b> 底层实现</a></li>
<li class="chapter" data-level="3.7.2" data-path="data-visualisation.html"><a href="data-visualisation.html#显式使用"><i class="fa fa-check"></i><b>3.7.2</b> 显式使用</a></li>
<li class="chapter" data-level="3.7.3" data-path="data-visualisation.html"><a href="data-visualisation.html#练习-1"><i class="fa fa-check"></i><b>3.7.3</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data-visualisation.html"><a href="data-visualisation.html#位置调整"><i class="fa fa-check"></i><b>3.8</b> 位置调整</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="data-visualisation.html"><a href="data-visualisation.html#条形图上色"><i class="fa fa-check"></i><b>3.8.1</b> 条形图上色</a></li>
<li class="chapter" data-level="3.8.2" data-path="data-visualisation.html"><a href="data-visualisation.html#位置调整功能"><i class="fa fa-check"></i><b>3.8.2</b> 位置调整功能</a></li>
<li class="chapter" data-level="3.8.3" data-path="data-visualisation.html"><a href="data-visualisation.html#练习-2"><i class="fa fa-check"></i><b>3.8.3</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="data-visualisation.html"><a href="data-visualisation.html#坐标系"><i class="fa fa-check"></i><b>3.9</b> 坐标系</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="data-visualisation.html"><a href="data-visualisation.html#练习-3"><i class="fa fa-check"></i><b>3.9.1</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="data-visualisation.html"><a href="data-visualisation.html#图形分层语法"><i class="fa fa-check"></i><b>3.10</b> 图形分层语法</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workflow-basics.html"><a href="workflow-basics.html"><i class="fa fa-check"></i><b>4</b> Workflow: basics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="workflow-basics.html"><a href="workflow-basics.html#代码基础"><i class="fa fa-check"></i><b>4.1</b> 代码基础</a></li>
<li class="chapter" data-level="4.2" data-path="workflow-basics.html"><a href="workflow-basics.html#对象名称"><i class="fa fa-check"></i><b>4.2</b> 对象名称</a></li>
<li class="chapter" data-level="4.3" data-path="workflow-basics.html"><a href="workflow-basics.html#函数调用"><i class="fa fa-check"></i><b>4.3</b> 函数调用</a></li>
<li class="chapter" data-level="4.4" data-path="workflow-basics.html"><a href="workflow-basics.html#练习-4"><i class="fa fa-check"></i><b>4.4</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>5</b> Data transformation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-transformation.html"><a href="data-transformation.html#简介"><i class="fa fa-check"></i><b>5.1</b> 简介</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-transformation.html"><a href="data-transformation.html#准备工作"><i class="fa fa-check"></i><b>5.1.1</b> 准备工作</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-transformation.html"><a href="data-transformation.html#tibble变量类型"><i class="fa fa-check"></i><b>5.1.2</b> tibble变量类型</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-transformation.html"><a href="data-transformation.html#dplyr基础"><i class="fa fa-check"></i><b>5.1.3</b> dplyr基础</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-transformation.html"><a href="data-transformation.html#使用filter筛选行"><i class="fa fa-check"></i><b>5.2</b> 使用<code>filter()</code>筛选行</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-transformation.html"><a href="data-transformation.html#练习-5"><i class="fa fa-check"></i><b>5.2.1</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-transformation.html"><a href="data-transformation.html#使用arrange排列行"><i class="fa fa-check"></i><b>5.3</b> 使用<code>arrange()</code>排列行</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-transformation.html"><a href="data-transformation.html#练习-6"><i class="fa fa-check"></i><b>5.3.1</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-transformation.html"><a href="data-transformation.html#使用select选择列"><i class="fa fa-check"></i><b>5.4</b> 使用<code>select()</code>选择列</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-transformation.html"><a href="data-transformation.html#练习-7"><i class="fa fa-check"></i><b>5.4.1</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-transformation.html"><a href="data-transformation.html#使用mutate添加新变量"><i class="fa fa-check"></i><b>5.5</b> 使用<code>mutate()</code>添加新变量</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-transformation.html"><a href="data-transformation.html#常用创建函数"><i class="fa fa-check"></i><b>5.5.1</b> 常用创建函数</a></li>
<li class="chapter" data-level="5.5.2" data-path="data-transformation.html"><a href="data-transformation.html#练习-8"><i class="fa fa-check"></i><b>5.5.2</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-transformation.html"><a href="data-transformation.html#使用summarize进行分组摘要"><i class="fa fa-check"></i><b>5.6</b> 使用<code>summarize()</code>进行分组摘要</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data-transformation.html"><a href="data-transformation.html#使用管道组合多种操作"><i class="fa fa-check"></i><b>5.6.1</b> 使用管道组合多种操作</a></li>
<li class="chapter" data-level="5.6.2" data-path="data-transformation.html"><a href="data-transformation.html#练习-9"><i class="fa fa-check"></i><b>5.6.2</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-transformation.html"><a href="data-transformation.html#分组新变量和筛选器"><i class="fa fa-check"></i><b>5.7</b> 分组新变量（和筛选器）</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="data-transformation.html"><a href="data-transformation.html#练习-10"><i class="fa fa-check"></i><b>5.7.1</b> 练习</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>6</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#两类问题"><i class="fa fa-check"></i><b>6.1</b> 两类问题</a></li>
<li class="chapter" data-level="6.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#一些tips"><i class="fa fa-check"></i><b>6.2</b> 一些tips</a></li>
<li class="chapter" data-level="6.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#练习-11"><i class="fa fa-check"></i><b>6.3</b> 练习</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#变动"><i class="fa fa-check"></i><b>6.3.1</b> 3-变动</a></li>
<li class="chapter" data-level="6.3.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#缺失值"><i class="fa fa-check"></i><b>6.3.2</b> 4-缺失值</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Wrangle</b></span></li>
<li class="chapter" data-level="7" data-path="tibbles.html"><a href="tibbles.html"><i class="fa fa-check"></i><b>7</b> Tibbles</a>
<ul>
<li class="chapter" data-level="7.1" data-path="tibbles.html"><a href="tibbles.html#准备工作-1"><i class="fa fa-check"></i><b>7.1</b> 准备工作</a></li>
<li class="chapter" data-level="7.2" data-path="tibbles.html"><a href="tibbles.html#创建tibble"><i class="fa fa-check"></i><b>7.2</b> 创建tibble</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="tibbles.html"><a href="tibbles.html#导图"><i class="fa fa-check"></i><b>7.2.1</b> 导图</a></li>
<li class="chapter" data-level="7.2.2" data-path="tibbles.html"><a href="tibbles.html#实践"><i class="fa fa-check"></i><b>7.2.2</b> 实践</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="tibbles.html"><a href="tibbles.html#对比tibble与data.frame"><i class="fa fa-check"></i><b>7.3</b> 对比<code>tibble</code>与<code>data.frame</code></a></li>
<li class="chapter" data-level="7.4" data-path="tibbles.html"><a href="tibbles.html#与旧代码进行交互"><i class="fa fa-check"></i><b>7.4</b> 与旧代码进行交互</a></li>
<li class="chapter" data-level="7.5" data-path="tibbles.html"><a href="tibbles.html#练习-12"><i class="fa fa-check"></i><b>7.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="data-import.html"><a href="data-import.html"><i class="fa fa-check"></i><b>8</b> Data import</a>
<ul>
<li class="chapter" data-level="8.1" data-path="data-import.html"><a href="data-import.html#简介-1"><i class="fa fa-check"></i><b>8.1</b> 简介</a></li>
<li class="chapter" data-level="8.2" data-path="data-import.html"><a href="data-import.html#入门"><i class="fa fa-check"></i><b>8.2</b> 入门</a></li>
<li class="chapter" data-level="8.3" data-path="data-import.html"><a href="data-import.html#解析向量"><i class="fa fa-check"></i><b>8.3</b> 解析向量</a></li>
<li class="chapter" data-level="8.4" data-path="data-import.html"><a href="data-import.html#解析文件"><i class="fa fa-check"></i><b>8.4</b> 解析文件</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="data-import.html"><a href="data-import.html#策略"><i class="fa fa-check"></i><b>8.4.1</b> 策略</a></li>
<li class="chapter" data-level="8.4.2" data-path="data-import.html"><a href="data-import.html#问题"><i class="fa fa-check"></i><b>8.4.2</b> 问题</a></li>
<li class="chapter" data-level="8.4.3" data-path="data-import.html"><a href="data-import.html#其他策略"><i class="fa fa-check"></i><b>8.4.3</b> 其他策略</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="data-import.html"><a href="data-import.html#写入文件"><i class="fa fa-check"></i><b>8.5</b> 写入文件</a></li>
<li class="chapter" data-level="8.6" data-path="data-import.html"><a href="data-import.html#练习-13"><i class="fa fa-check"></i><b>8.6</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>9</b> Tidy data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="tidy-data.html"><a href="tidy-data.html#整齐的数据"><i class="fa fa-check"></i><b>9.1</b> 整齐的数据</a></li>
<li class="chapter" data-level="9.2" data-path="tidy-data.html"><a href="tidy-data.html#数据的常见问题与整理方法"><i class="fa fa-check"></i><b>9.2</b> 数据的常见问题与整理方法</a></li>
<li class="chapter" data-level="9.3" data-path="tidy-data.html"><a href="tidy-data.html#缺失值-1"><i class="fa fa-check"></i><b>9.3</b> 缺失值</a></li>
<li class="chapter" data-level="9.4" data-path="tidy-data.html"><a href="tidy-data.html#练习-14"><i class="fa fa-check"></i><b>9.4</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>10</b> Relational data</a>
<ul>
<li class="chapter" data-level="10.1" data-path="relational-data.html"><a href="relational-data.html#键"><i class="fa fa-check"></i><b>10.1</b> 键</a></li>
<li class="chapter" data-level="10.2" data-path="relational-data.html"><a href="relational-data.html#处理关系数据的三种操作"><i class="fa fa-check"></i><b>10.2</b> 处理关系数据的三种操作</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="relational-data.html"><a href="relational-data.html#定义键列"><i class="fa fa-check"></i><b>10.2.1</b> 定义键列</a></li>
<li class="chapter" data-level="10.2.2" data-path="relational-data.html"><a href="relational-data.html#连接中的问题"><i class="fa fa-check"></i><b>10.2.2</b> 连接中的问题</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="relational-data.html"><a href="relational-data.html#练习-15"><i class="fa fa-check"></i><b>10.3</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>11</b> Strings</a>
<ul>
<li class="chapter" data-level="11.1" data-path="strings.html"><a href="strings.html#字符串基础"><i class="fa fa-check"></i><b>11.1</b> 字符串基础</a></li>
<li class="chapter" data-level="11.2" data-path="strings.html"><a href="strings.html#使用正则表达式进行模式匹配"><i class="fa fa-check"></i><b>11.2</b> 使用正则表达式进行模式匹配</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="strings.html"><a href="strings.html#练习-16"><i class="fa fa-check"></i><b>11.2.1</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="strings.html"><a href="strings.html#工具"><i class="fa fa-check"></i><b>11.3</b> 工具</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="strings.html"><a href="strings.html#导图-1"><i class="fa fa-check"></i><b>11.3.1</b> 导图</a></li>
<li class="chapter" data-level="11.3.2" data-path="strings.html"><a href="strings.html#关于匹配的一些注意"><i class="fa fa-check"></i><b>11.3.2</b> 关于匹配的一些注意</a></li>
<li class="chapter" data-level="11.3.3" data-path="strings.html"><a href="strings.html#boundary"><i class="fa fa-check"></i><b>11.3.3</b> boundary()</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="strings.html"><a href="strings.html#其他"><i class="fa fa-check"></i><b>11.4</b> 其他</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="factors.html"><a href="factors.html"><i class="fa fa-check"></i><b>12</b> Factors</a>
<ul>
<li class="chapter" data-level="12.1" data-path="factors.html"><a href="factors.html#导图-2"><i class="fa fa-check"></i><b>12.1</b> 导图</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="dates-and-times.html"><a href="dates-and-times.html"><i class="fa fa-check"></i><b>13</b> Dates and times</a>
<ul>
<li class="chapter" data-level="13.1" data-path="dates-and-times.html"><a href="dates-and-times.html#创建日期或时间"><i class="fa fa-check"></i><b>13.1</b> 创建日期或时间</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="dates-and-times.html"><a href="dates-and-times.html#导图-3"><i class="fa fa-check"></i><b>13.1.1</b> 导图</a></li>
<li class="chapter" data-level="13.1.2" data-path="dates-and-times.html"><a href="dates-and-times.html#处理flights日期时间数据"><i class="fa fa-check"></i><b>13.1.2</b> 处理<code>flights</code>日期时间数据</a></li>
<li class="chapter" data-level="13.1.3" data-path="dates-and-times.html"><a href="dates-and-times.html#绘图"><i class="fa fa-check"></i><b>13.1.3</b> 绘图</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="dates-and-times.html"><a href="dates-and-times.html#日期时间成分"><i class="fa fa-check"></i><b>13.2</b> 日期时间成分</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="dates-and-times.html"><a href="dates-and-times.html#导图-4"><i class="fa fa-check"></i><b>13.2.1</b> 导图</a></li>
<li class="chapter" data-level="13.2.2" data-path="dates-and-times.html"><a href="dates-and-times.html#获取day成分"><i class="fa fa-check"></i><b>13.2.2</b> 获取day成分</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="dates-and-times.html"><a href="dates-and-times.html#时间间隔"><i class="fa fa-check"></i><b>13.3</b> 时间间隔</a></li>
<li class="chapter" data-level="13.4" data-path="dates-and-times.html"><a href="dates-and-times.html#时区"><i class="fa fa-check"></i><b>13.4</b> 时区</a></li>
</ul></li>
<li class="part"><span><b>III Program</b></span></li>
<li class="chapter" data-level="14" data-path="pipes.html"><a href="pipes.html"><i class="fa fa-check"></i><b>14</b> Pipes</a></li>
<li class="chapter" data-level="15" data-path="vectors.html"><a href="vectors.html"><i class="fa fa-check"></i><b>15</b> Vectors</a>
<ul>
<li class="chapter" data-level="15.1" data-path="vectors.html"><a href="vectors.html#一个很长的导图"><i class="fa fa-check"></i><b>15.1</b> 一个很长的导图</a></li>
<li class="chapter" data-level="15.2" data-path="vectors.html"><a href="vectors.html#导图补充"><i class="fa fa-check"></i><b>15.2</b> 导图补充</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="vectors.html"><a href="vectors.html#全局字符串池"><i class="fa fa-check"></i><b>15.2.1</b> 全局字符串池</a></li>
<li class="chapter" data-level="15.2.2" data-path="vectors.html"><a href="vectors.html#一些数值型特殊值的检查"><i class="fa fa-check"></i><b>15.2.2</b> 一些数值型特殊值的检查</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="vectors.html"><a href="vectors.html#练习-17"><i class="fa fa-check"></i><b>15.3</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="iteration.html"><a href="iteration.html"><i class="fa fa-check"></i><b>16</b> Iteration</a>
<ul>
<li class="chapter" data-level="16.1" data-path="iteration.html"><a href="iteration.html#一个很长的导图-1"><i class="fa fa-check"></i><b>16.1</b> 一个很长的导图</a></li>
<li class="chapter" data-level="16.2" data-path="iteration.html"><a href="iteration.html#导图补充-1"><i class="fa fa-check"></i><b>16.2</b> 导图补充</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="iteration.html"><a href="iteration.html#循环模式名称"><i class="fa fa-check"></i><b>16.2.1</b> 循环模式：名称</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="iteration.html"><a href="iteration.html#练习-18"><i class="fa fa-check"></i><b>16.3</b> 练习</a></li>
</ul></li>
<li class="part"><span><b>IV Model</b></span></li>
<li class="chapter" data-level="17" data-path="model-intro.html"><a href="model-intro.html"><i class="fa fa-check"></i><b>17</b> Introduction</a></li>
<li class="chapter" data-level="18" data-path="model-basics.html"><a href="model-basics.html"><i class="fa fa-check"></i><b>18</b> model-basics</a>
<ul>
<li class="chapter" data-level="18.1" data-path="model-basics.html"><a href="model-basics.html#思维导图"><i class="fa fa-check"></i><b>18.1</b> 思维导图</a></li>
<li class="chapter" data-level="18.2" data-path="model-basics.html"><a href="model-basics.html#导图补充-2"><i class="fa fa-check"></i><b>18.2</b> 导图补充</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">r4ds学习笔记</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualisation" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Data visualisation</h1>
<div id="introduction" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Introduction</h2>
<p>我们将要学习的第一套工具，<code>ggplot2</code>的程序包，用于绘图。</p>
<p>首先加载<code>tidyverse</code></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="data-visualisation.html#cb1-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="data-visualisation.html#cb1-2"></a><span class="co">#&gt; -- Attaching packages ----------------</span></span>
<span id="cb1-3"><a href="data-visualisation.html#cb1-3"></a><span class="co">#&gt; √ ggplot2 3.3.2     √ purrr   0.3.4</span></span>
<span id="cb1-4"><a href="data-visualisation.html#cb1-4"></a><span class="co">#&gt; √ tibble  3.0.3     √ dplyr   1.0.2</span></span>
<span id="cb1-5"><a href="data-visualisation.html#cb1-5"></a><span class="co">#&gt; √ tidyr   1.1.1     √ stringr 1.4.0</span></span>
<span id="cb1-6"><a href="data-visualisation.html#cb1-6"></a><span class="co">#&gt; √ readr   1.3.1     √ forcats 0.5.0</span></span>
<span id="cb1-7"><a href="data-visualisation.html#cb1-7"></a><span class="co">#&gt; -- Conflicts -------------------------</span></span>
<span id="cb1-8"><a href="data-visualisation.html#cb1-8"></a><span class="co">#&gt; x dplyr::filter() masks stats::filter()</span></span>
<span id="cb1-9"><a href="data-visualisation.html#cb1-9"></a><span class="co">#&gt; x dplyr::lag()    masks stats::lag()</span></span></code></pre></div>
</div>
<div id="first-steps" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> First steps</h2>
<p>先绘制一个<code>mpg</code>数据框里边的引擎大小(<code>displ</code>)-燃油效率(<code>hwy</code>)散点图</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="data-visualisation.html#cb2-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg)<span class="op">+</span></span>
<span id="cb2-2"><a href="data-visualisation.html#cb2-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ,<span class="dt">y =</span> hwy))</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-7-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>可以看到，绘图的模板命令大致是</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="data-visualisation.html#cb3-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb3-2"><a href="data-visualisation.html#cb3-2"></a><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="data-visualisation.html#cb4-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) </span></code></pre></div>
<p>这是在生成一个空白图层，指定数据。</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="data-visualisation.html#cb5-1"></a><span class="op">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>))</span></code></pre></div>
<p>这是在空白图层上方继续加图层，比如前面的<code>geom_point</code>就是加上散点图图层。<code>mapping</code>是映射，是将数据框的属性映射成图形属性，常见的我们还用<code>aes()</code>，这是将将数据框的属性映射成<code>x,y</code>轴变量。</p>
<div id="exercises" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>运行<code>ggplot(data = mpg)</code>，你会看到什么？</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="data-visualisation.html#cb6-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg)</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>显然，是一个空白的图层。</p>
<ol start="2" style="list-style-type: decimal">
<li>数据集<code>mpg</code>中有多少行？多少列？</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="data-visualisation.html#cb7-1"></a><span class="kw">str</span>(mpg)</span>
<span id="cb7-2"><a href="data-visualisation.html#cb7-2"></a><span class="co">#&gt; tibble [234 x 11] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb7-3"><a href="data-visualisation.html#cb7-3"></a><span class="co">#&gt;  $ manufacturer: chr [1:234] &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; ...</span></span>
<span id="cb7-4"><a href="data-visualisation.html#cb7-4"></a><span class="co">#&gt;  $ model       : chr [1:234] &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; ...</span></span>
<span id="cb7-5"><a href="data-visualisation.html#cb7-5"></a><span class="co">#&gt;  $ displ       : num [1:234] 1.8 1.8 2 2 2.8 2.8 3.1 1.8 1.8 2 ...</span></span>
<span id="cb7-6"><a href="data-visualisation.html#cb7-6"></a><span class="co">#&gt;  $ year        : int [1:234] 1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 ...</span></span>
<span id="cb7-7"><a href="data-visualisation.html#cb7-7"></a><span class="co">#&gt;  $ cyl         : int [1:234] 4 4 4 4 6 6 6 4 4 4 ...</span></span>
<span id="cb7-8"><a href="data-visualisation.html#cb7-8"></a><span class="co">#&gt;  $ trans       : chr [1:234] &quot;auto(l5)&quot; &quot;manual(m5)&quot; &quot;manual(m6)&quot; &quot;auto(av)&quot; ...</span></span>
<span id="cb7-9"><a href="data-visualisation.html#cb7-9"></a><span class="co">#&gt;  $ drv         : chr [1:234] &quot;f&quot; &quot;f&quot; &quot;f&quot; &quot;f&quot; ...</span></span>
<span id="cb7-10"><a href="data-visualisation.html#cb7-10"></a><span class="co">#&gt;  $ cty         : int [1:234] 18 21 20 21 16 18 18 18 16 20 ...</span></span>
<span id="cb7-11"><a href="data-visualisation.html#cb7-11"></a><span class="co">#&gt;  $ hwy         : int [1:234] 29 29 31 30 26 26 27 26 25 28 ...</span></span>
<span id="cb7-12"><a href="data-visualisation.html#cb7-12"></a><span class="co">#&gt;  $ fl          : chr [1:234] &quot;p&quot; &quot;p&quot; &quot;p&quot; &quot;p&quot; ...</span></span>
<span id="cb7-13"><a href="data-visualisation.html#cb7-13"></a><span class="co">#&gt;  $ class       : chr [1:234] &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; ...</span></span></code></pre></div>
<p>利用<code>str</code>函数，可以得到数据集<code>mpg</code>中有234行11列。</p>
<ol start="3" style="list-style-type: decimal">
<li>变量<code>drv</code>的意义是什么？使用<code>?mpg</code>命令阅读帮助文件以找出答案。</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="data-visualisation.html#cb8-1"></a>?mpg</span></code></pre></div>
<p>通过阅读帮助文档可以知道</p>
<blockquote>
<p>drv: the type of drive train, where f = front-wheel drive, r = rear wheel drive, 4 = 4wd</p>
</blockquote>
<p>即传动系的类型，f表示前轮驱动，r表示后轮驱动，4表示四轮驱动。</p>
<ol start="4" style="list-style-type: decimal">
<li>使用<code>hwy</code>和<code>cyl</code>绘制一张散点图。</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="data-visualisation.html#cb9-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg)<span class="op">+</span></span>
<span id="cb9-2"><a href="data-visualisation.html#cb9-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> hwy,<span class="dt">y =</span> cyl))</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>啊，这奇怪的图形。</p>
<ol start="5" style="list-style-type: decimal">
<li>如果使用<code>class</code>和<code>drv</code>绘制散点图，会发生什么情况？为什么这张图没什么用处？</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="data-visualisation.html#cb10-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg)<span class="op">+</span></span>
<span id="cb10-2"><a href="data-visualisation.html#cb10-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> class,<span class="dt">y =</span> drv))</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>会出现很多点重合的现象，这是这张图没什么用处的原因吗？但是自我感觉还是保留了些许信息，但的确被压缩了很多。</p>
</div>
</div>
<div id="aesthetic-mappings" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Aesthetic mappings</h2>
<p>我们在前面学习了如何把数据框属性映射为<code>x,y</code>轴，实际上还可以映射其他图形属性。</p>
<p>在引擎大小(<code>displ</code>)-燃油效率(<code>hwy</code>)散点图中增加多一个映射，将点的颜色映射为变量<code>class</code></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="data-visualisation.html#cb11-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-2"><a href="data-visualisation.html#cb11-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> class))</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-16-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>类似于点的颜色，还有的图形属性为：</p>
<ul>
<li><p>点的透明度<code>alpha</code></p></li>
<li><p>点的大小<code>size</code>，单位为毫米</p></li>
<li><p>点的形状<code>shape</code>，<code>ggplot2</code>只能同时使用<strong>6</strong>种形状</p></li>
<li><p>还可以通过<code>?geom_point</code>来查看</p></li>
</ul>
<p>除了映射图形属性让<code>ggplot2</code>帮忙设置，还可以手动为几何对象设置图形属性。</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="data-visualisation.html#cb12-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb12-2"><a href="data-visualisation.html#cb12-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy),<span class="dt">colour =</span> <span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;" />
上图会将所有点都绘制成蓝色，因为我们并没有对点的颜色建立映射，而是直接设置。这与前面的图不同。</p>
<div id="exercises-1" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>以下这段代码有什么错误？为什么点不是蓝色的？</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="data-visualisation.html#cb13-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-2"><a href="data-visualisation.html#cb13-2"></a><span class="st">  </span><span class="kw">geom_point</span>( </span>
<span id="cb13-3"><a href="data-visualisation.html#cb13-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) </span>
<span id="cb13-4"><a href="data-visualisation.html#cb13-4"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>这是因为这段代码把字符串常量当作数据框属性映射为点的颜色，由于各点的值都是常量“blue”故大家的颜色也一样，为默认的第一种颜色：红色。</p>
<p>事实上，</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="data-visualisation.html#cb14-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-2"><a href="data-visualisation.html#cb14-2"></a><span class="st">  </span><span class="kw">geom_point</span>( </span>
<span id="cb14-3"><a href="data-visualisation.html#cb14-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> <span class="st">&quot;hello&quot;</span>) </span>
<span id="cb14-4"><a href="data-visualisation.html#cb14-4"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-19-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>不论那个字符串是什么，甚至不是颜色的字符串也没有什么影响的。</p>
<p>(2)<code>mpg</code>中的哪些变量是分类变量？哪些变量是连续变量？（提示：输入<code>?mpg</code>来阅读这个数据集的文档。）当调用<code>mpg</code>时，如何才能看到这些信息？</p>
<p>当然可以阅读文档，但也可以</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="data-visualisation.html#cb15-1"></a><span class="kw">str</span>(mpg)</span>
<span id="cb15-2"><a href="data-visualisation.html#cb15-2"></a><span class="co">#&gt; tibble [234 x 11] (S3: tbl_df/tbl/data.frame)</span></span>
<span id="cb15-3"><a href="data-visualisation.html#cb15-3"></a><span class="co">#&gt;  $ manufacturer: chr [1:234] &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; &quot;audi&quot; ...</span></span>
<span id="cb15-4"><a href="data-visualisation.html#cb15-4"></a><span class="co">#&gt;  $ model       : chr [1:234] &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; &quot;a4&quot; ...</span></span>
<span id="cb15-5"><a href="data-visualisation.html#cb15-5"></a><span class="co">#&gt;  $ displ       : num [1:234] 1.8 1.8 2 2 2.8 2.8 3.1 1.8 1.8 2 ...</span></span>
<span id="cb15-6"><a href="data-visualisation.html#cb15-6"></a><span class="co">#&gt;  $ year        : int [1:234] 1999 1999 2008 2008 1999 1999 2008 1999 1999 2008 ...</span></span>
<span id="cb15-7"><a href="data-visualisation.html#cb15-7"></a><span class="co">#&gt;  $ cyl         : int [1:234] 4 4 4 4 6 6 6 4 4 4 ...</span></span>
<span id="cb15-8"><a href="data-visualisation.html#cb15-8"></a><span class="co">#&gt;  $ trans       : chr [1:234] &quot;auto(l5)&quot; &quot;manual(m5)&quot; &quot;manual(m6)&quot; &quot;auto(av)&quot; ...</span></span>
<span id="cb15-9"><a href="data-visualisation.html#cb15-9"></a><span class="co">#&gt;  $ drv         : chr [1:234] &quot;f&quot; &quot;f&quot; &quot;f&quot; &quot;f&quot; ...</span></span>
<span id="cb15-10"><a href="data-visualisation.html#cb15-10"></a><span class="co">#&gt;  $ cty         : int [1:234] 18 21 20 21 16 18 18 18 16 20 ...</span></span>
<span id="cb15-11"><a href="data-visualisation.html#cb15-11"></a><span class="co">#&gt;  $ hwy         : int [1:234] 29 29 31 30 26 26 27 26 25 28 ...</span></span>
<span id="cb15-12"><a href="data-visualisation.html#cb15-12"></a><span class="co">#&gt;  $ fl          : chr [1:234] &quot;p&quot; &quot;p&quot; &quot;p&quot; &quot;p&quot; ...</span></span>
<span id="cb15-13"><a href="data-visualisation.html#cb15-13"></a><span class="co">#&gt;  $ class       : chr [1:234] &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; &quot;compact&quot; ...</span></span>
<span id="cb15-14"><a href="data-visualisation.html#cb15-14"></a><span class="kw">summary</span>(mpg)</span>
<span id="cb15-15"><a href="data-visualisation.html#cb15-15"></a><span class="co">#&gt;  manufacturer          model               displ           year     </span></span>
<span id="cb15-16"><a href="data-visualisation.html#cb15-16"></a><span class="co">#&gt;  Length:234         Length:234         Min.   :1.60   Min.   :1999  </span></span>
<span id="cb15-17"><a href="data-visualisation.html#cb15-17"></a><span class="co">#&gt;  Class :character   Class :character   1st Qu.:2.40   1st Qu.:1999  </span></span>
<span id="cb15-18"><a href="data-visualisation.html#cb15-18"></a><span class="co">#&gt;  Mode  :character   Mode  :character   Median :3.30   Median :2004  </span></span>
<span id="cb15-19"><a href="data-visualisation.html#cb15-19"></a><span class="co">#&gt;                                        Mean   :3.47   Mean   :2004  </span></span>
<span id="cb15-20"><a href="data-visualisation.html#cb15-20"></a><span class="co">#&gt;                                        3rd Qu.:4.60   3rd Qu.:2008  </span></span>
<span id="cb15-21"><a href="data-visualisation.html#cb15-21"></a><span class="co">#&gt;                                        Max.   :7.00   Max.   :2008  </span></span>
<span id="cb15-22"><a href="data-visualisation.html#cb15-22"></a><span class="co">#&gt;       cyl          trans               drv                 cty      </span></span>
<span id="cb15-23"><a href="data-visualisation.html#cb15-23"></a><span class="co">#&gt;  Min.   :4.00   Length:234         Length:234         Min.   : 9.0  </span></span>
<span id="cb15-24"><a href="data-visualisation.html#cb15-24"></a><span class="co">#&gt;  1st Qu.:4.00   Class :character   Class :character   1st Qu.:14.0  </span></span>
<span id="cb15-25"><a href="data-visualisation.html#cb15-25"></a><span class="co">#&gt;  Median :6.00   Mode  :character   Mode  :character   Median :17.0  </span></span>
<span id="cb15-26"><a href="data-visualisation.html#cb15-26"></a><span class="co">#&gt;  Mean   :5.89                                         Mean   :16.9  </span></span>
<span id="cb15-27"><a href="data-visualisation.html#cb15-27"></a><span class="co">#&gt;  3rd Qu.:8.00                                         3rd Qu.:19.0  </span></span>
<span id="cb15-28"><a href="data-visualisation.html#cb15-28"></a><span class="co">#&gt;  Max.   :8.00                                         Max.   :35.0  </span></span>
<span id="cb15-29"><a href="data-visualisation.html#cb15-29"></a><span class="co">#&gt;       hwy            fl               class          </span></span>
<span id="cb15-30"><a href="data-visualisation.html#cb15-30"></a><span class="co">#&gt;  Min.   :12.0   Length:234         Length:234        </span></span>
<span id="cb15-31"><a href="data-visualisation.html#cb15-31"></a><span class="co">#&gt;  1st Qu.:18.0   Class :character   Class :character  </span></span>
<span id="cb15-32"><a href="data-visualisation.html#cb15-32"></a><span class="co">#&gt;  Median :24.0   Mode  :character   Mode  :character  </span></span>
<span id="cb15-33"><a href="data-visualisation.html#cb15-33"></a><span class="co">#&gt;  Mean   :23.4                                        </span></span>
<span id="cb15-34"><a href="data-visualisation.html#cb15-34"></a><span class="co">#&gt;  3rd Qu.:27.0                                        </span></span>
<span id="cb15-35"><a href="data-visualisation.html#cb15-35"></a><span class="co">#&gt;  Max.   :44.0</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>将一个连续变量映射为<code>color</code>、<code>size</code>和<code>shape</code>。对分类变量和连续变量来说，这些图形
属性的表现有什么不同？</li>
</ol>
<p>实践是检验真理的唯一标准，我们试试看：</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="data-visualisation.html#cb16-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-2"><a href="data-visualisation.html#cb16-2"></a><span class="st">  </span><span class="kw">geom_point</span>( </span>
<span id="cb16-3"><a href="data-visualisation.html#cb16-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> cty) </span>
<span id="cb16-4"><a href="data-visualisation.html#cb16-4"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-21-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="data-visualisation.html#cb17-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-2"><a href="data-visualisation.html#cb17-2"></a><span class="st">  </span><span class="kw">geom_point</span>( </span>
<span id="cb17-3"><a href="data-visualisation.html#cb17-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">size =</span> cty) </span>
<span id="cb17-4"><a href="data-visualisation.html#cb17-4"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-22-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="data-visualisation.html#cb18-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-2"><a href="data-visualisation.html#cb18-2"></a><span class="st">  </span><span class="kw">geom_point</span>( </span>
<span id="cb18-3"><a href="data-visualisation.html#cb18-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">shape =</span> cty) </span>
<span id="cb18-4"><a href="data-visualisation.html#cb18-4"></a>  )</span></code></pre></div>
<p>前两个还好，后面这个形状是直接报错无法映射了。毕竟<code>color</code>还有<code>size</code>都是可以渐变也即可以建立连续映射到连续的，但是形状就是铁定的离散值了，无法与连续值建立映射。</p>
<p>(4)如果将同一个变量映射为多个图形属性，会发生什么情况？</p>
<p>试试看：</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="data-visualisation.html#cb19-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-2"><a href="data-visualisation.html#cb19-2"></a><span class="st">  </span><span class="kw">geom_point</span>( </span>
<span id="cb19-3"><a href="data-visualisation.html#cb19-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">colour =</span> class, <span class="dt">size =</span> class) </span>
<span id="cb19-4"><a href="data-visualisation.html#cb19-4"></a>  )</span>
<span id="cb19-5"><a href="data-visualisation.html#cb19-5"></a><span class="co">#&gt; Warning: Using size for a discrete variable is not advised.</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>咦，会叠加的耶。</p>
<p>(5)<code>stroke</code>这个图形属性的作用是什么？它适用于哪些形状？（提示：使用<code>?geom_point</code>命令。）</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="data-visualisation.html#cb20-1"></a>?geom_point</span></code></pre></div>
<p>但是里面没有具体涉及。实践一下</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="data-visualisation.html#cb21-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-2"><a href="data-visualisation.html#cb21-2"></a><span class="st">  </span><span class="kw">geom_point</span>( </span>
<span id="cb21-3"><a href="data-visualisation.html#cb21-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">stroke =</span> cty<span class="op">*</span><span class="fl">0.2</span>, <span class="dt">size =</span> cty) </span>
<span id="cb21-4"><a href="data-visualisation.html#cb21-4"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-26-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>查阅https://ggplot2.tidyverse.org/articles/ggplot2-specs.html#colour-and-fill-1， <code>stroke</code>这个图形属性是用于21-24形状的点的描边大小。</p>
<ol start="6" style="list-style-type: decimal">
<li>如果将图形属性映射为非变量名对象，比如<code>aes(color = displ &lt; 5)</code>，会发生什么情况？</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="data-visualisation.html#cb22-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-2"><a href="data-visualisation.html#cb22-2"></a><span class="st">  </span><span class="kw">geom_point</span>( </span>
<span id="cb22-3"><a href="data-visualisation.html#cb22-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> displ <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>) </span>
<span id="cb22-4"><a href="data-visualisation.html#cb22-4"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-27-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>嗯，还是可以映射成图形属性的。</p>
</div>
</div>
<div id="common-problems" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Common problems</h2>
<p>这样子是错的</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="data-visualisation.html#cb23-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg)</span>
<span id="cb23-2"><a href="data-visualisation.html#cb23-2"></a><span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> class))</span></code></pre></div>
<p>加号要放在代码的末尾。</p>
</div>
<div id="facets分面" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Facets分面</h2>
<p>一个参数的分面：利用函数<code>facet_wrap()</code>。例如：</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="data-visualisation.html#cb24-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-2"><a href="data-visualisation.html#cb24-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-3"><a href="data-visualisation.html#cb24-3"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>class, <span class="dt">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-29-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>每一个“面”都是属性<code>class</code>的一个值，所以<strong>传递给<code>facet_wrap()</code>的变量应该是离散型的</strong>。参数<code>nrow</code>表示分面的行数。</p>
<p>两个参数的分面：利用函数<code>facet_grid()</code>。例如：</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="data-visualisation.html#cb25-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-2"><a href="data-visualisation.html#cb25-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-3"><a href="data-visualisation.html#cb25-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(drv <span class="op">~</span><span class="st"> </span>cyl)</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-30-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>每一个面都由(<code>cyl</code>,<code>drv</code>)决定。</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="data-visualisation.html#cb26-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb26-2"><a href="data-visualisation.html#cb26-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb26-3"><a href="data-visualisation.html#cb26-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>cyl)</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-31-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>想要取消在行的维度分面，用<code>.</code>替代属性。</p>
<div id="exercises-2" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>如果使用连续变量进行分面，会发生什么情况？</li>
</ol>
<p>看一个参数的：</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="data-visualisation.html#cb27-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb27-2"><a href="data-visualisation.html#cb27-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb27-3"><a href="data-visualisation.html#cb27-3"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>cty, <span class="dt">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-32-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>可以看到它会把连续变量的所有取值都绘制分面了。</p>
<ol start="2" style="list-style-type: decimal">
<li>在使用<code>facet_grid(drv ~ cyl)</code>生成的图中，空白单元的意义是什么？它们和以下代码
生成的图有什么关系？</li>
</ol>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="data-visualisation.html#cb28-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb28-2"><a href="data-visualisation.html#cb28-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> drv, <span class="dt">y =</span> cyl))</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-33-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>而</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="data-visualisation.html#cb29-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span></span>
<span id="cb29-2"><a href="data-visualisation.html#cb29-2"></a><span class="st">  </span><span class="kw">facet_grid</span>(drv <span class="op">~</span><span class="st"> </span>cyl)</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-34-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>这个图只是对变量<code>drv</code>,<code>cyl</code>绘制分面，而上图是对这两个变量绘制散点图。</p>
<ol start="3" style="list-style-type: decimal">
<li>以下代码会绘制出什么图？ . 的作用是什么？</li>
</ol>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="data-visualisation.html#cb30-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-2"><a href="data-visualisation.html#cb30-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-3"><a href="data-visualisation.html#cb30-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(drv <span class="op">~</span><span class="st"> </span>.) </span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-35-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="data-visualisation.html#cb31-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-2"><a href="data-visualisation.html#cb31-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-3"><a href="data-visualisation.html#cb31-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>cyl)</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-36-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>这两幅图实际上是按单个变量按列或行分面，与<code>facet_warp()</code>不同之处：</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="data-visualisation.html#cb32-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-2"><a href="data-visualisation.html#cb32-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-3"><a href="data-visualisation.html#cb32-3"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>cyl)</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-37-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>facet_warp()</code>对单个变量分面不会考虑按行或者按列。</p>
<ol start="4" style="list-style-type: decimal">
<li>查看本节的第一个分面图，
<img src="r4ds-study-notes_files/figure-html/unnamed-chunk-38-1.png" width="70%" style="display: block; margin: auto;" /></li>
</ol>
<p>与使用图形属性相比，使用分面的优势和劣势分别是什么？如果有一个更大的数据集，你将如何权衡这两种方法的优劣？</p>
<p>使用分面的优势：可以更好地看清，在固定某个变量（上图的<code>class</code>）时其余两个变量的关系。劣势就是三个变量的共同作用不太好看清了。</p>
<p>所以我觉得，当我们要考虑多个变量的共同作用、相互关系时可以考虑使用图形属性，当我们想要固定某个变量考虑其他变量时可以考虑分面。</p>
<ol start="5" style="list-style-type: decimal">
<li>阅读<code>?facet_wrap</code>的帮助页面。<code>nrow</code>和<code>ncol</code>的功能分别是什么？还有哪些选项可以控
制分面的布局？为什么函数<code>facet_grid()</code>没有变量<code>nrow</code>和<code>ncol</code>？</li>
</ol>
<p><code>nrow</code>和<code>ncol</code>的功能分别是控制分面图的行列个数。函数<code>facet_grid()</code>的行列数是依赖于分面变量的取值数，所以无法自定义。</p>
<ol start="6" style="list-style-type: decimal">
<li>在使用函数<code>facet_grid()</code>时，一般应该将具有更多唯一值的变量放在列上。为什么这么做呢？</li>
</ol>
<p>增加分面图的行数，从而每幅图看起来更好看、清晰，吧。</p>
</div>
</div>
<div id="几何对象" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> 几何对象</h2>
<p>几何对象是图中用来表示数据的几何图形对象，在ggplot2中使用几何对象函数来实现，比如
<code>geom_point(),geom_smooth()</code>等等，对于同一个数据对象，使用什么样的几何对象来展示，这估计也是一个大学问啊。</p>
<p>ggplot2中每个几何对象函数都有<code>mapping</code>参数，但并不意味着可以任意设置所有的图形属性，比如<code>geom_point()</code>就没有<code>linetype</code>属性。每个几何对象的详情可以使用帮助<code>?geom_point</code>。</p>
<div id="分组绘图" class="section level3" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> 分组绘图</h3>
<p>使用单一几何对象实现分组绘图：</p>
<ul>
<li>将一个图形属性映射为一个离散变量，自动添加图例（巨方便）</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="data-visualisation.html#cb33-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb33-2"><a href="data-visualisation.html#cb33-2"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> drv)) </span>
<span id="cb33-3"><a href="data-visualisation.html#cb33-3"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-40-1.png" width="70%" style="display: block; margin: auto;" /></p>
<ul>
<li>使用<code>group</code>参数</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="data-visualisation.html#cb34-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb34-2"><a href="data-visualisation.html#cb34-2"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">group =</span> drv)) </span>
<span id="cb34-3"><a href="data-visualisation.html#cb34-3"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-41-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="多个几何对象" class="section level3" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> 多个几何对象</h3>
<p>想要在一幅图上显示多个几何对象，只需要把图层不断叠加。例如：</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="data-visualisation.html#cb35-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb35-2"><a href="data-visualisation.html#cb35-2"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy))<span class="op">+</span></span>
<span id="cb35-3"><a href="data-visualisation.html#cb35-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy))</span>
<span id="cb35-4"><a href="data-visualisation.html#cb35-4"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-42-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>可以看到，两个几何对象的映射是重复的，可以用全局映射替代。即</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="data-visualisation.html#cb36-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy))<span class="op">+</span></span>
<span id="cb36-2"><a href="data-visualisation.html#cb36-2"></a><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></span>
<span id="cb36-3"><a href="data-visualisation.html#cb36-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>()</span>
<span id="cb36-4"><a href="data-visualisation.html#cb36-4"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-43-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>这样修改全局映射就会对所有几何对象有影响。</p>
<p>关于全局映射与局部映射：全局映射会作用与所有几何对象，局部映射只会作用与当前几何对象，并且局部映射可以拓展（不冲突时）或者覆盖全局映射（冲突时）。对于全局指定数据集以及局部指定数据集也类似。例如，</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="data-visualisation.html#cb37-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb37-2"><a href="data-visualisation.html#cb37-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">color =</span> class)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb37-3"><a href="data-visualisation.html#cb37-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>( </span>
<span id="cb37-4"><a href="data-visualisation.html#cb37-4"></a>    <span class="dt">data =</span> <span class="kw">filter</span>(mpg, class <span class="op">==</span><span class="st"> &quot;subcompact&quot;</span>), </span>
<span id="cb37-5"><a href="data-visualisation.html#cb37-5"></a>    <span class="dt">se =</span> <span class="ot">FALSE</span> </span>
<span id="cb37-6"><a href="data-visualisation.html#cb37-6"></a>  )</span>
<span id="cb37-7"><a href="data-visualisation.html#cb37-7"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-44-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>上例中，全局指定数据集与局部指定数据集冲突，所以几何对象<code>geom_smooth</code>只绘制了局部指定的数据集。局部映射<code>color = class</code>与全局映射不冲突，所以几何对象<code>geom_point</code>被三个映射作用。</p>
</div>
<div id="练习" class="section level3" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> 练习</h3>
<ol style="list-style-type: decimal">
<li>在绘制折线图、箱线图、直方图和分区图时，应该分别使用哪种几何对象？</li>
</ol>
<p>参考： <a href="https://ggplot2.tidyverse.org/reference/index.html" class="uri">https://ggplot2.tidyverse.org/reference/index.html</a>。</p>
<ol start="2" style="list-style-type: decimal">
<li>在脑海中运行以下代码，并预测会有何种输出。接着在R中运行代码，并检查你的预测是否正确。</li>
</ol>
<p>预测：对数据中变量<code>drv</code>不同值分别绘制散点图并绘制该散点图的平滑拟合曲线。</p>
<p>实际：</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="data-visualisation.html#cb38-1"></a><span class="kw">ggplot</span>( </span>
<span id="cb38-2"><a href="data-visualisation.html#cb38-2"></a>  <span class="dt">data =</span> mpg, </span>
<span id="cb38-3"><a href="data-visualisation.html#cb38-3"></a>  <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy, <span class="dt">color =</span> drv) </span>
<span id="cb38-4"><a href="data-visualisation.html#cb38-4"></a>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-5"><a href="data-visualisation.html#cb38-5"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb38-6"><a href="data-visualisation.html#cb38-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>)</span>
<span id="cb38-7"><a href="data-visualisation.html#cb38-7"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-45-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>嗯，一样的。</p>
<ol start="3" style="list-style-type: decimal">
<li><code>show.legend = FALSE</code>的作用是什么？删除它会发生什么情况？你觉得我为什么要在本
章前面的示例中使用这句代码？</li>
</ol>
<p>作用是不显示图例，删除它就显示图例呗。为了体现将一个图形属性映射为一个离散变量时ggplot2可以自动添加图例。</p>
<ol start="4" style="list-style-type: decimal">
<li><code>geom_smooth()</code>函数中的<code>se</code>参数的作用是什么？</li>
</ol>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="data-visualisation.html#cb39-1"></a>?geom_smooth</span></code></pre></div>
<p>可以看到<code>se</code>参数的作用是控制是否展示拟合曲线的置信区间。</p>
<ol start="5" style="list-style-type: decimal">
<li>以下代码生成的两张图有什么区别吗？为什么？</li>
</ol>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="data-visualisation.html#cb40-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-2"><a href="data-visualisation.html#cb40-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb40-3"><a href="data-visualisation.html#cb40-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>() </span>
<span id="cb40-4"><a href="data-visualisation.html#cb40-4"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-47-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="data-visualisation.html#cb41-1"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-2"><a href="data-visualisation.html#cb41-2"></a><span class="st">  </span><span class="kw">geom_point</span>( </span>
<span id="cb41-3"><a href="data-visualisation.html#cb41-3"></a>    <span class="dt">data =</span> mpg, </span>
<span id="cb41-4"><a href="data-visualisation.html#cb41-4"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy) </span>
<span id="cb41-5"><a href="data-visualisation.html#cb41-5"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-6"><a href="data-visualisation.html#cb41-6"></a><span class="st">  </span><span class="kw">geom_smooth</span>( </span>
<span id="cb41-7"><a href="data-visualisation.html#cb41-7"></a>    <span class="dt">data =</span> mpg, </span>
<span id="cb41-8"><a href="data-visualisation.html#cb41-8"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy) </span>
<span id="cb41-9"><a href="data-visualisation.html#cb41-9"></a>  )</span>
<span id="cb41-10"><a href="data-visualisation.html#cb41-10"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-48-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>一样的呀，不就是把全局变量放在局部变量那里吗…</p>
<ol start="6" style="list-style-type: decimal">
<li>自己编写R代码来生成以下各图。</li>
</ol>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="data-visualisation.html#cb42-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-2"><a href="data-visualisation.html#cb42-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb42-3"><a href="data-visualisation.html#cb42-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se=</span>F) </span>
<span id="cb42-4"><a href="data-visualisation.html#cb42-4"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-49-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="data-visualisation.html#cb43-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-2"><a href="data-visualisation.html#cb43-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb43-3"><a href="data-visualisation.html#cb43-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>( <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">group=</span>drv),<span class="dt">se=</span>F) </span>
<span id="cb43-4"><a href="data-visualisation.html#cb43-4"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-50-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="data-visualisation.html#cb44-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy,<span class="dt">color=</span>drv)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-2"><a href="data-visualisation.html#cb44-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-3"><a href="data-visualisation.html#cb44-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se=</span>F) </span>
<span id="cb44-4"><a href="data-visualisation.html#cb44-4"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-51-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="data-visualisation.html#cb45-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-2"><a href="data-visualisation.html#cb45-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">color=</span>drv)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb45-3"><a href="data-visualisation.html#cb45-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se=</span>F) </span>
<span id="cb45-4"><a href="data-visualisation.html#cb45-4"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-52-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="data-visualisation.html#cb46-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-2"><a href="data-visualisation.html#cb46-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">color=</span>drv)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb46-3"><a href="data-visualisation.html#cb46-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se=</span>F,<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">linetype=</span>drv))</span>
<span id="cb46-4"><a href="data-visualisation.html#cb46-4"></a><span class="co">#&gt; `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</span></span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-53-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="data-visualisation.html#cb47-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb47-2"><a href="data-visualisation.html#cb47-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">color=</span>drv))</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-54-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="统计变换" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> 统计变换</h2>
<p>很多图形绘制的是数据集的原始数据，比如散点图,它把原始数据中已有的变量映射到图形属性中。</p>
<p>另外一些图形则可以绘制那些计算出的新数据，比如条形图。例如，</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="data-visualisation.html#cb48-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb48-2"><a href="data-visualisation.html#cb48-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut))</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-55-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>y轴的<code>count</code>变量是原始数据中所没有的，是通过<strong>统计变换（stat）</strong>后得到的。所以对于这些函数，它们作用的过程可以分为两步，先是处理原始数据集，后是将处理后的数据集的变量映射到图形属性。但我们往往不需要关注底层统计变换的实现过程。</p>
<div id="底层实现" class="section level3" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> 底层实现</h3>
<p>当我们需要关注底层实现过程的时候，我们需要知道：</p>
<ul>
<li><p>通过查看<code>stat</code>参数的默认值，可以知道几何对象函数使用了哪种统计变换函数。统计函数会计算出不止一个新变量，例如可以通过<code>?geom_bar</code>的Computed variables一节看到。</p></li>
<li><p>统计变换函数指的是实现某种统计变换的函数，例如<code>count-&gt;stat_count()</code>。</p></li>
<li><p>通常来说，几何对象函数和统计变换函数可以互换使用，如<code>geom_bar</code>与<code>stat_count</code>，因为每个几何对象函数都有一个默认统计变换，每个统计变换函数都有一个默认几何对象</p></li>
</ul>
</div>
<div id="显式使用" class="section level3" number="3.7.2">
<h3><span class="header-section-number">3.7.2</span> 显式使用</h3>
<p>当我们想要显式使用某种统计变换时，</p>
<ul>
<li>想要覆盖默认的统计变换：更改<code>stat</code>参数值，并指定各图形属性的映射。例</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="data-visualisation.html#cb49-1"></a>demo &lt;-<span class="st"> </span><span class="kw">tribble</span>( </span>
<span id="cb49-2"><a href="data-visualisation.html#cb49-2"></a>  <span class="op">~</span>a,      <span class="op">~</span>b, </span>
<span id="cb49-3"><a href="data-visualisation.html#cb49-3"></a>  <span class="st">&quot;bar_1&quot;</span>, <span class="dv">20</span>, </span>
<span id="cb49-4"><a href="data-visualisation.html#cb49-4"></a>  <span class="st">&quot;bar_2&quot;</span>, <span class="dv">30</span>, </span>
<span id="cb49-5"><a href="data-visualisation.html#cb49-5"></a>  <span class="st">&quot;bar_3&quot;</span>, <span class="dv">40</span> </span>
<span id="cb49-6"><a href="data-visualisation.html#cb49-6"></a>) </span>
<span id="cb49-7"><a href="data-visualisation.html#cb49-7"></a> </span>
<span id="cb49-8"><a href="data-visualisation.html#cb49-8"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> demo) <span class="op">+</span><span class="st"> </span></span>
<span id="cb49-9"><a href="data-visualisation.html#cb49-9"></a><span class="st">  </span><span class="kw">geom_bar</span>( </span>
<span id="cb49-10"><a href="data-visualisation.html#cb49-10"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> a, <span class="dt">y =</span> b), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span> </span>
<span id="cb49-11"><a href="data-visualisation.html#cb49-11"></a>  )</span>
<span id="cb49-12"><a href="data-visualisation.html#cb49-12"></a></span>
<span id="cb49-13"><a href="data-visualisation.html#cb49-13"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> demo) <span class="op">+</span><span class="st"> </span></span>
<span id="cb49-14"><a href="data-visualisation.html#cb49-14"></a><span class="st">  </span><span class="kw">geom_bar</span>( </span>
<span id="cb49-15"><a href="data-visualisation.html#cb49-15"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> a)</span>
<span id="cb49-16"><a href="data-visualisation.html#cb49-16"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-56-1.png" width="70%" style="display: block; margin: auto;" /><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-56-2.png" width="70%" style="display: block; margin: auto;" />
其中，<code>stat = "identity"</code>表示不使用统计变换（即使用恒等变换）。</p>
<ul>
<li>想要覆盖从统计变换生成的变量到图形属性的默认映射。</li>
</ul>
<p>前面我们说过，统计函数会计算出不止一个新变量，我们可以显示地更改变量到图形属性的默认映射，例如，默认的：</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="data-visualisation.html#cb50-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb50-2"><a href="data-visualisation.html#cb50-2"></a><span class="st">  </span><span class="kw">geom_bar</span>( </span>
<span id="cb50-3"><a href="data-visualisation.html#cb50-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut) </span>
<span id="cb50-4"><a href="data-visualisation.html#cb50-4"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-57-1.png" width="70%" style="display: block; margin: auto;" />
<code>stat_count</code>计算的变量除了<code>count</code>（默认映射）还有<code>prop</code>，更改一下映射：</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="data-visualisation.html#cb51-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb51-2"><a href="data-visualisation.html#cb51-2"></a><span class="st">  </span><span class="kw">geom_bar</span>( </span>
<span id="cb51-3"><a href="data-visualisation.html#cb51-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span>) </span>
<span id="cb51-4"><a href="data-visualisation.html#cb51-4"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-58-1.png" width="70%" style="display: block; margin: auto;" />
可以看到<code>y = ..prop..</code>而不是<code>y = prop</code>估计是为了表明这个<code>prop</code>是统计变换计算出来的中间变量，而不是原始数据中的变量。验证一下：</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="data-visualisation.html#cb52-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb52-2"><a href="data-visualisation.html#cb52-2"></a><span class="st">  </span><span class="kw">geom_bar</span>( </span>
<span id="cb52-3"><a href="data-visualisation.html#cb52-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">y =</span> ..count.., <span class="dt">group =</span> <span class="dv">1</span>) </span>
<span id="cb52-4"><a href="data-visualisation.html#cb52-4"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-59-1.png" width="70%" style="display: block; margin: auto;" />
可以得到默认的绘图。</p>
<ul>
<li>想要在代码中强调统计变换。而非几何对象。如</li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="data-visualisation.html#cb53-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb53-2"><a href="data-visualisation.html#cb53-2"></a><span class="st">  </span><span class="kw">stat_summary</span>( </span>
<span id="cb53-3"><a href="data-visualisation.html#cb53-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">y =</span> depth), </span>
<span id="cb53-4"><a href="data-visualisation.html#cb53-4"></a>    <span class="dt">fun.min =</span> min, </span>
<span id="cb53-5"><a href="data-visualisation.html#cb53-5"></a>    <span class="dt">fun.max =</span> max, </span>
<span id="cb53-6"><a href="data-visualisation.html#cb53-6"></a>    <span class="dt">fun =</span> median </span>
<span id="cb53-7"><a href="data-visualisation.html#cb53-7"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-60-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="练习-1" class="section level3" number="3.7.3">
<h3><span class="header-section-number">3.7.3</span> 练习</h3>
<ol style="list-style-type: decimal">
<li><code>stat_summary()</code>函数的默认几何对象是什么？不使用统计变换函数的话，如何使用几何对象函数重新生成以上的图？</li>
</ol>
<p>可以看到<code>geom = "pointrange"</code>，从而默认的几何对象为<code>geom_pointrange</code>。利用<code>pointrange</code>生成图如下：</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="data-visualisation.html#cb54-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb54-2"><a href="data-visualisation.html#cb54-2"></a><span class="st">  </span><span class="kw">geom_pointrange</span>(</span>
<span id="cb54-3"><a href="data-visualisation.html#cb54-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">y =</span> depth), </span>
<span id="cb54-4"><a href="data-visualisation.html#cb54-4"></a>    <span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>,</span>
<span id="cb54-5"><a href="data-visualisation.html#cb54-5"></a>    <span class="dt">fun.min =</span> min, </span>
<span id="cb54-6"><a href="data-visualisation.html#cb54-6"></a>    <span class="dt">fun.max =</span> max, </span>
<span id="cb54-7"><a href="data-visualisation.html#cb54-7"></a>    <span class="dt">fun =</span> median </span>
<span id="cb54-8"><a href="data-visualisation.html#cb54-8"></a>    )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-62-1.png" width="70%" style="display: block; margin: auto;" />
默认是不做统计变换，所以要显示指定一下参数<code>stat</code>。</p>
<ol start="2" style="list-style-type: decimal">
<li><code>geom_col()</code>函数的功能是什么？它和<code>geom_bar()</code>函数有何不同？</li>
</ol>
<p><code>geom_col()</code>函数默认不使用统计变换，即需要把原始数据中某个变量映射到y轴上。<code>geom_bar()</code>函数默认使用统计变换。</p>
<ol start="3" style="list-style-type: decimal">
<li>多数几何对象和统计变换都是成对出现的，总是配合使用。仔细阅读文档，列出所有
成对的几何对象和统计变换。它们有什么共同之处？</li>
</ol>
<p>参考：<a href="https://ggplot2.tidyverse.org/reference/index.html" class="uri">https://ggplot2.tidyverse.org/reference/index.html</a> 。名字大多类似？</p>
<ol start="4" style="list-style-type: decimal">
<li><code>stat_smooth()</code>函数会计算出什么变量？哪些参数可以控制它的行为？</li>
</ol>
<p><code>y</code>：预测值，<code>ymin,ymax</code>：y均值的置信区间，<code>se</code>：标准误差。嗯…太多了…</p>
<ol start="5" style="list-style-type: decimal">
<li>在比例条形图中，我们需要设定<code>group = 1</code>，这是为什么呢？换句话说，以下两张图会
有什么问题？</li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="data-visualisation.html#cb55-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb55-2"><a href="data-visualisation.html#cb55-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">y =</span> ..prop..)) </span>
<span id="cb55-3"><a href="data-visualisation.html#cb55-3"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb55-4"><a href="data-visualisation.html#cb55-4"></a><span class="st">  </span><span class="kw">geom_bar</span>( </span>
<span id="cb55-5"><a href="data-visualisation.html#cb55-5"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> color, <span class="dt">y =</span> ..prop..) </span>
<span id="cb55-6"><a href="data-visualisation.html#cb55-6"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-63-1.png" width="70%" style="display: block; margin: auto;" /><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-63-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>你需要把所有数据放在一个组里面考虑，否则对于<code>cut</code>的每一个值分为一组，<code>prop</code>值都会是1。只需要把一个常量映射为<code>group</code>参数即可。</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="data-visualisation.html#cb56-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb56-2"><a href="data-visualisation.html#cb56-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">y =</span> ..prop..,<span class="dt">group=</span><span class="st">&quot;hello&quot;</span>)) </span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-64-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="位置调整" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> 位置调整</h2>
<div id="条形图上色" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> 条形图上色</h3>
<p>使用<code>color</code>或者<code>fill</code>图形属性</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="data-visualisation.html#cb57-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb57-2"><a href="data-visualisation.html#cb57-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">color =</span> cut)) </span>
<span id="cb57-3"><a href="data-visualisation.html#cb57-3"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb57-4"><a href="data-visualisation.html#cb57-4"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> cut))</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-65-1.png" width="70%" style="display: block; margin: auto;" /><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-65-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>可以看到，<code>color</code>为边框上色，<code>fill</code>为图形填充颜色。</p>
<p>改变<code>fill</code>映射的变量，可以得到分块堆砌条形图。</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="data-visualisation.html#cb58-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-2"><a href="data-visualisation.html#cb58-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> clarity))</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-66-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="位置调整功能" class="section level3" number="3.8.2">
<h3><span class="header-section-number">3.8.2</span> 位置调整功能</h3>
<p>这是由<code>position</code>参数设定的位置调整功能自动完成的，默认为<code>stack</code>（堆砌），还有其余值为<code>identity,fill,dodge</code>。</p>
<ul>
<li><code>position = "identity"</code>：将每个对象直接显示在图中，在图层上进行堆砌。这种方式不太适合条形图，因为条形会彼此重叠。为了让重叠部分能够显示出来，我们可以设置<code>alpha</code>参数为一个较小的数，从而使得条形略微透明；或者设定<code>fill = NA</code>，让条形完全透明：</li>
</ul>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="data-visualisation.html#cb59-1"></a><span class="kw">ggplot</span>( </span>
<span id="cb59-2"><a href="data-visualisation.html#cb59-2"></a>  <span class="dt">data =</span> diamonds, </span>
<span id="cb59-3"><a href="data-visualisation.html#cb59-3"></a>  <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> clarity) </span>
<span id="cb59-4"><a href="data-visualisation.html#cb59-4"></a>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb59-5"><a href="data-visualisation.html#cb59-5"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>, <span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>) </span>
<span id="cb59-6"><a href="data-visualisation.html#cb59-6"></a><span class="kw">ggplot</span>( </span>
<span id="cb59-7"><a href="data-visualisation.html#cb59-7"></a>  <span class="dt">data =</span> diamonds, </span>
<span id="cb59-8"><a href="data-visualisation.html#cb59-8"></a>  <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">color =</span> clarity) </span>
<span id="cb59-9"><a href="data-visualisation.html#cb59-9"></a>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb59-10"><a href="data-visualisation.html#cb59-10"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-67-1.png" width="70%" style="display: block; margin: auto;" /><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-67-2.png" width="70%" style="display: block; margin: auto;" /></p>
<ul>
<li><code>position = "fill"</code>：与堆叠相似，但每组堆叠条形具有同样的高度，因此这种条形图可以非常轻松地比较各组间的<strong>比例</strong>：</li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="data-visualisation.html#cb60-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb60-2"><a href="data-visualisation.html#cb60-2"></a><span class="st">  </span><span class="kw">geom_bar</span>( </span>
<span id="cb60-3"><a href="data-visualisation.html#cb60-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> clarity), </span>
<span id="cb60-4"><a href="data-visualisation.html#cb60-4"></a>    <span class="dt">position =</span> <span class="st">&quot;fill&quot;</span> </span>
<span id="cb60-5"><a href="data-visualisation.html#cb60-5"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-68-1.png" width="70%" style="display: block; margin: auto;" /></p>
<ul>
<li><code>position = "dodge"</code>将每组中的条形依次并列放置，这样可以非常轻松地比较每个条形
表示的<strong>具体数值</strong>：</li>
</ul>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="data-visualisation.html#cb61-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb61-2"><a href="data-visualisation.html#cb61-2"></a><span class="st">  </span><span class="kw">geom_bar</span>( </span>
<span id="cb61-3"><a href="data-visualisation.html#cb61-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> clarity), </span>
<span id="cb61-4"><a href="data-visualisation.html#cb61-4"></a>    <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span> </span>
<span id="cb61-5"><a href="data-visualisation.html#cb61-5"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-69-1.png" width="70%" style="display: block; margin: auto;" /></p>
<ul>
<li><code>position = "jitter"</code>：虽然不适合条形图，但非常适合散点图。它为每个数据点添加一个很小的随机扰动，这样就可以将重叠的点分散开来。用损失精确性的方法提高图形的启发性，我觉得想法非常棒呀，毕竟图形化本身就是在用降低精确性来提高启发性。</li>
</ul>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="data-visualisation.html#cb62-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span><span class="st"> </span></span>
<span id="cb62-2"><a href="data-visualisation.html#cb62-2"></a><span class="st">  </span><span class="kw">geom_point</span>( </span>
<span id="cb62-3"><a href="data-visualisation.html#cb62-3"></a>    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> displ, <span class="dt">y =</span> hwy), </span>
<span id="cb62-4"><a href="data-visualisation.html#cb62-4"></a>    <span class="dt">position =</span> <span class="st">&quot;jitter&quot;</span> </span>
<span id="cb62-5"><a href="data-visualisation.html#cb62-5"></a>  )</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-70-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="练习-2" class="section level3" number="3.8.3">
<h3><span class="header-section-number">3.8.3</span> 练习</h3>
<p>(1)以下图形有什么问题？应该如何改善？</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="data-visualisation.html#cb63-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cty, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb63-2"><a href="data-visualisation.html#cb63-2"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-71-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>重叠点太多，加入随机扰动看看：</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="data-visualisation.html#cb64-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cty, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb64-2"><a href="data-visualisation.html#cb64-2"></a><span class="st">  </span><span class="kw">geom_jitter</span>()</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-72-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>效果要好一点。</p>
<p>(2)<code>geom_jitter()</code>使用哪些参数来控制抖动的程度？</p>
<p><code>width,height</code>，但不太清楚作用机制…</p>
<p>(3)对比 <code>geom_jitter()</code> 与 <code>geom_count()</code>。</p>
<p><code>geom_jitter()</code>通过对数据点加随机扰动把重叠点分开，而 <code>geom_count()</code>对于重叠点，将重叠点计数映射到改区域点的大小。即</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="data-visualisation.html#cb65-1"></a><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(cty, hwy)) <span class="op">+</span></span>
<span id="cb65-2"><a href="data-visualisation.html#cb65-2"></a><span class="st"> </span><span class="kw">geom_count</span>()</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-73-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>(4)<code>geom_boxplot()</code>函数的默认位置调整方式是什么？创建<code>mpg</code>数据集的可视化表示来演示一下。</p>
<p>默认位置调整方式是<code>dodge2</code>。</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="data-visualisation.html#cb66-1"></a><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(class, hwy))<span class="op">+</span><span class="st"> </span></span>
<span id="cb66-2"><a href="data-visualisation.html#cb66-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-74-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="坐标系" class="section level2" number="3.9">
<h2><span class="header-section-number">3.9</span> 坐标系</h2>
<ul>
<li><p><code>coord_flip()</code>交换x轴，y轴；</p></li>
<li><p><code>coord_quickmap()</code>为地图设置合适的纵横比；</p></li>
<li><p><code>coord_polar()</code>采用极坐标；</p></li>
</ul>
<div id="练习-3" class="section level3" number="3.9.1">
<h3><span class="header-section-number">3.9.1</span> 练习</h3>
<p>(1)使用<code>coord_polar()</code>函数将堆叠式条形图转换为饼图。</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="data-visualisation.html#cb67-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds) <span class="op">+</span><span class="st"> </span></span>
<span id="cb67-2"><a href="data-visualisation.html#cb67-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> clarity))<span class="op">+</span></span>
<span id="cb67-3"><a href="data-visualisation.html#cb67-3"></a><span class="st">  </span><span class="kw">coord_polar</span>()</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-75-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>(2)<code>labs()</code>函数的功能是什么？阅读一下文档。</p>
<p>修改标签。</p>
<p>(3)<code>coord_quickmap()</code>函数和 <code>coord_map()</code> 函数的区别是什么？</p>
<p>参考：<a href="https://ggplot2.tidyverse.org/reference/coord_map.html" class="uri">https://ggplot2.tidyverse.org/reference/coord_map.html</a></p>
<p>(4)下图表明城市和公路燃油效率之间有什么关系？为什么<code>coord_fixed()</code>函数很重要？<code>geom_abline()</code> 函数的作用是什么？</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="data-visualisation.html#cb68-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cty, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb68-2"><a href="data-visualisation.html#cb68-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb68-3"><a href="data-visualisation.html#cb68-3"></a><span class="st">  </span><span class="kw">geom_abline</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb68-4"><a href="data-visualisation.html#cb68-4"></a><span class="st">  </span><span class="kw">coord_fixed</span>()</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-76-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>正相关（线性）。可以使数据点（看起来）成斜率为1或-1，否则就是</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="data-visualisation.html#cb69-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> cty, <span class="dt">y =</span> hwy)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb69-2"><a href="data-visualisation.html#cb69-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb69-3"><a href="data-visualisation.html#cb69-3"></a><span class="st">  </span><span class="kw">geom_abline</span>()</span></code></pre></div>
<p><img src="r4ds-study-notes_files/figure-html/unnamed-chunk-77-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><code>geom_abline()</code> 函数的作用是绘制参考直线。</p>
</div>
</div>
<div id="图形分层语法" class="section level2" number="3.10">
<h2><span class="header-section-number">3.10</span> 图形分层语法</h2>
<p>模板语法：</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="data-visualisation.html#cb70-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb70-2"><a href="data-visualisation.html#cb70-2"></a><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>( </span>
<span id="cb70-3"><a href="data-visualisation.html#cb70-3"></a>     <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>), </span>
<span id="cb70-4"><a href="data-visualisation.html#cb70-4"></a>     <span class="dt">stat =</span> <span class="op">&lt;</span>STAT<span class="op">&gt;</span>, </span>
<span id="cb70-5"><a href="data-visualisation.html#cb70-5"></a>     <span class="dt">position =</span> <span class="op">&lt;</span>POSITION<span class="op">&gt;</span><span class="st"> </span></span>
<span id="cb70-6"><a href="data-visualisation.html#cb70-6"></a><span class="st">  </span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb70-7"><a href="data-visualisation.html#cb70-7"></a><span class="st">  </span><span class="er">&lt;</span>COORDINATE_FUNCTION<span class="op">&gt;</span><span class="st"> </span><span class="op">+</span><span class="st"> </span></span>
<span id="cb70-8"><a href="data-visualisation.html#cb70-8"></a><span class="st">  </span><span class="er">&lt;</span>FACET_FUNCTION<span class="op">&gt;</span></span></code></pre></div>
<p>如果构建一个图形？</p>
<p>1.需要有一个数据集<code>&lt;DATA&gt;</code></p>
<p>2.（通过统计变换<code>&lt;STAT&gt;</code>）将其转换为想要显示的信息</p>
<p>3.选择一个几何对象<code>&lt;GEOM_FUNCTION&gt;</code>来表示转换后的数据中的每个观测值，</p>
<p>4.选择几何对象的图形属性来表示数据中的变量，这会将每个变量的值映射<code>&lt;MAPPINGS&gt;</code>为图形属性的水平。</p>
<p>5.选择放置几何对象的坐标系<code>&lt;COORDINATE_FUNCTION&gt;</code></p>
<p>6.进一步调整几何对象在坐标系中的位置（位置调整<code>&lt;POSITION&gt;</code>），或者将图划分为多个子图（分面<code>&lt;FACET_FUNCTION&gt;</code>）</p>
<p>7.添加一个或多个附加图层进行拓展。</p>

</div>
</div>
<section style="
    display: block;
">
<script src="https://utteranc.es/client.js"
        repo="huanghaicheng1024/r4ds-study-notes"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</section>
            </section>

          </div>
        </div>
      </div>
<a href="explore-intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="workflow-basics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/huanghaicheng1024/r4ds-study-notes/edit/master/03-visualize.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "none"
},
"search": false
});
});
</script>

</body>

</html>
